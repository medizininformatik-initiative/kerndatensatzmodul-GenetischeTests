@startuml MII_MolGen_Profile_Relationships_Simplified
skinparam backgroundColor white
skinparam component {
    BackgroundColor<<Workflow>> #E8F4FD
    BackgroundColor<<Finding>> #E8F8E8
    BackgroundColor<<Implication>> #FFF8E8
    BackgroundColor<<Biomarker>> #F8E8F8
    BackgroundColor<<Study>> #FFE8E8
    BackgroundColor<<Task>> #F0F0F0
    BorderColor #333333
    BorderThickness 2
    ArrowColor #333333
    ArrowThickness 2
}

skinparam note {
    BackgroundColor #FFFFCC
    BorderColor #333333
}

title <size:18>MII Molekulargenetischer Befundbericht - Hauptprofile und Beziehungen</size>

' Main Workflow
package "Workflow" <<Workflow>> {
    component "ServiceRequest\n(Anforderung)" as SR
    component "DiagnosticReport\n(Befundbericht)" as DR
}

' Genetic Findings
package "Genetische Befunde" <<Finding>> {
    component "Variante" as VAR
    component "Genotyp" as GEN
    component "Haplotype" as HAP
}

' Implications
package "Genetische Implikationen" <<Implication>> {
    component "Molekulare\nKonsequenz" as MK
    component "Diagnostische\nImplikation" as DI
    component "Therapeutische\nImplikation" as TI
}

' Biomarkers
package "Molekulare Biomarker" <<Biomarker>> {
    component "Mutationslast" as TMB
    component "Mikrosatelliten-\ninstabilität" as MSI
    component "Polygener\nRisiko Score" as PRS
}

' Studies
package "Methodik" <<Study>> {
    component "GenomicStudy" as GS
    component "GenomicStudy\nAnalysis" as GSA
}

' Recommendations
package "Therapieempfehlungen" <<Task>> {
    component "Medikations-\nempfehlung" as MED
    component "Empfohlene\nFolgemaßnahme" as FOL
}

' Primary Workflow
DR -[#blue,bold]-> SR : "basedOn"

' Report Results
DR -[#green]-> VAR : "result"
DR -[#green]-> GEN : "result"
DR -[#green]-> HAP : "result"
DR -[#orange]-> DI : "result"
DR -[#orange]-> TI : "result"
DR -[#purple]-> TMB : "result"
DR -[#purple]-> MSI : "result"
DR -[#red]-> GS : "extension[genomic-study]"

' Variant Relationships
VAR -[#darkgreen]-> MK : "hasMember"
VAR <-- GEN : "derivedFrom"
VAR <-- HAP : "derivedFrom"
VAR <-- DI : "derivedFrom"
VAR <-- TI : "derivedFrom"
VAR <-- MK : "derivedFrom"

' Study Relationships
GS -[#red]-> GSA : "extension[genomic-study-analysis]"
GS --> SR : "reasonReference"
GS <-- VAR : "derivedFrom"
GS <-- TMB : "derivedFrom"
GS <-- MSI : "derivedFrom"

' Task Relationships
DR -[#gray]-> MED : "extension[recommended-action]"
DR -[#gray]-> FOL : "extension[recommended-action]"
MED --> TI : "focus"
FOL --> DI : "focus"

' Risk Score
PRS --> VAR : "basis"

note right of DR
  **Zentrale Koordination**
  Der DiagnosticReport verbindet
  alle Ergebnisse und Empfehlungen
end note

note bottom of VAR
  **Kernbefund**
  Varianten sind die Basis für
  Implikationen und Genotypen
end note

@enduml